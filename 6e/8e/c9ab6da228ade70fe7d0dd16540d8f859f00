警告のフィルタリングなどを行なえるコールバックメソッドを定義する Warning.warn メソッドのデフォルトの実装に追加のキーワード引数を受け付けるようにして、警告出力時にこのメソッドを呼び出す際に category キーワード引数で警告のカテゴリ(あれば)を Symbol で渡すようにしています。過去に再定義した Warning.warn はキーワード引数を受付けないように定義されてるかもしれないので、呼び出す時に arity をチェックして 1じゃない時だけ渡すようにしています。将来の拡張のために再定義の時も category を直接受け取るように書く(だけ)ではなくて keyword rest 引数として受け取るようにしたほうが良いですね、というのがどこかに書かれてたほうが良さそうですね。 https://github.com/ruby/ruby/pull/3418 [ruby-core:99582] [Feature #17122]
