C で実装されたメソッドでの例外や break 等の制御文の実行のために rb_thread_t 構
造体の state というメンバに確かビットフラグで情報を保持しているのですが、[DEL:
例外:DEL] break 処理中に[DEL:割り込み処理(シグナルハンドラやファイナライザ)
:DEL]set_trace_func で設定された hook の呼び出し(2010-09-02 修正)の処理が入り込
んだ時にそれを書き換えてないので割り込み処理内で例外が再発生してしまってスタッ
クのつじつまが合わなくなって落ちるという [Bug #3722]について
[ruby-dev:42162] で投稿されたパッチがコミットされています。投稿者の芝さんは割り
込み処理中に別の例外が発生した時にどうするのか気にされてますがこのままなんでし
ょうか。多分これだと例外は無視されるのでそれでいいのかもしれません。
どうでもいいですが state の他に似たような用途で tag というメンバもあった気がす
るんですが何が違うんだったか。一度は読んだはずなんですが忘れてしまってます。し
ょんぼり。
