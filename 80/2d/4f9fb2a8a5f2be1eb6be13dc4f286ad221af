r48927 の続きで、リトライ時に切り詰められた文字列をバッファとして渡してしまうこ
とでバッファオーバフローが起こり得るようになっていたのを修正しています。
[ruby-core:65295] [Bug #10300]
