527829423088f09cf2f708be12bb4337d640dc69 の変更で複雑になった return 文を switch 文で分解してみやすくリファクタリングしています。
