fork した時にデッドロックしてしまっていたので pthread_atfork は親プロセスだけで
設定して fork した子プロセスでは再設定しないようにしています。[DEL:ということは
2段 fork したらまずいんですよね、きっと。2段 fork は daemonize の時の常套手段で
すが、 1.9 には Process.daemon があるからまあ使わないか。:DEL]
[追記]コメントで教えていただきました。 pthread_atfork の設定は fork した時子プ
ロセスに引き継がれるため、再度 pthread_atfork を呼ぶ必要はないようです。むしろ
呼ぶと固まるようですね[/追記]
