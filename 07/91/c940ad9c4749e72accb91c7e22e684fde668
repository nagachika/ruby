ruby_atomic.h で atomic 操作のために使っていた __sync_xxx() のビルトイン関数は
最新の GCC ではもう legacy になっているそうで、__atomic_xxx ビルトイン関数をチ
ェックしてこちらが利用可能だったら使うように configure のチェックとマクロ定義を
追加しています。コンパイラの進化は速いなぁ。
