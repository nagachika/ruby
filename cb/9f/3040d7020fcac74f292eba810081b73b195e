configure でシステムコール dup3(2) の存在をチェックして、存在していたら
rb_cloexec_dup2() で dup2(2) のかわりに利用するようにしています。 dup3() も
Linux で最近追加されたシステムコールみたいで、始めて知りました。 dup2() との違
いは「呼び出し元が、新しいファイルディスクリプタに対して close-on-exec フラグを
強制的に設定することができる。これを行うには、flags に O_CLOEXEC を指定する」だ
そうです。これも 2.6.27 からでないと利用できないので、定義があっても呼んでみて
、errno=ENOSYS で返ってきたらもう使わないように工夫されてます。
