Hash#shift という要素を破壊的にキーと値の配列として取り出すメソッドが、その
Hash オブジェクトがブロックを受け取るメソッドでイテレーション中だった時のことを
考慮して rb_hash_foreach() を呼ぶようにしていたのを、RHASH_ITER_LEV(hash) をチ
ェックしてイテレーション中でなかったら直接削除するようにしています。またこのた
めに st.c に st_shift() という関数を追加しています。 [ruby-core:54524] [Bug #
8312]
Hash#shift なんてあったんですね。使ったことないや。
