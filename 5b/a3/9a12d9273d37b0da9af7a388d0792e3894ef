Marhsal.dump 時の内部的なインスタンス変数(@ で始まらない変数名のもの)と、エンコ
ーディングの扱いを修正しているようです。エンコーディングのほうは encoding index
ではなくてエンコーディング名を使って dump するようにしているようです。多分イン
デックスより名前のほうが変化に強いからだと思います。インスタンス変数のほうは内
部的なインスタンス変数は別途 dump するから ivar として dump しないのでその数あ
わせをしているのかなぁという感じです。
