拡張ライブラリ psych の Psych::ScalarScanner で整数を tokenize する時の正規表現を修正して例外的な処理しているのを整理しています。ところで知らなかったのですが、YAML の整数で桁の区切りにカンマが書けるんですね。つまり "123,456,789" みたいに書いて 123456789 という整数になる。これ配列を JSON 風に書いた時に衝突するんじゃないかと思ったのですが、この処理はあくまで scalar の処理するものなので配列の要素の分解は別にされているみたいで、 "[123,456,789]" と書いたのを Psych.load するとちゃんと 3要素の配列になりました。うーん、きもちわるい仕様(たぶん YAML の仕様ですよね)。
