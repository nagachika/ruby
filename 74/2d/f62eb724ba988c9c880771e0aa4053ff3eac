r64766 の追加修正。条件の and と or が反転してたので修正しています。
[ruby-core:89058] [Bug #15116]
