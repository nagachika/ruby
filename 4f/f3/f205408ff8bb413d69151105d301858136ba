gcc でヘッダファイルの include を抑制するのに書く #ifndef の分岐はファイルの先頭になくてはならず、コメントが前にあってもヘッダの open すらスキップする最適化を阻害してしまう(もちろん preprocess 後に空になるという効果はあると思いますが)みたいなので、#ifndef と #define を置くのをファイル先頭に移動しています。また GCC や MSVC では #pragma once というのも効くそうですが Sun C でこれが使えないとのこと。こういう最適化してくれるんですね。 [ruby-core:97750] [Bug #16770]
