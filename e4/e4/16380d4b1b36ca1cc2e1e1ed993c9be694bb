GC.compact でオブジェクト移動した後に machine stack 上の参照っぽいものをチェックして、その参照先が移動していた(T_MOVED 型になってた)時には対応できないので(マシンスタック上の参照っぽいものは本当に VALUE かわからないので書きかえるわけにもいかないので)移動をとりやめて元に戻すようにしています。移動開始時に GC でマークするはずですが、GC.compact の移動処理中にも並行して動いている可能性がある(Ractor 対応?)ので移動後に元の位置への参照ができてしまってる可能性があるみたいです。具体的になにか問題があったのかなぁ。
