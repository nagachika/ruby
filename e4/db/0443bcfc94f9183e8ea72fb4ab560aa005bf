rb_eval_string_wrap() という C API は文字列を ruby スクリプトとして実行して、その時モジュールのコンテキストは(cref)はすりかえるとドキュメントにはあるけど実際には変更してなかったので、rb_vm_cref_new_toplevel() で新しい cref を作ってそこで実行するようにしています。この新しい cref はその後どうなるんだろう……。ずっと残るのかな。 [ruby-core:66049] [Bug #10466]
