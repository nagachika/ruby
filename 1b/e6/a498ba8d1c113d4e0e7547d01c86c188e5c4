BigDecimal#** で累乗の計算をする時に Real::obj のオブジェクトが利用中に
BigDecimal_exp() を呼ぶので GC で解放されてしまう(Real::obj はマークされておら
ず、bigdecimal.c では必要に応じて ENTER()/SAVE()/GUARD_OBJ() などのマクロで保護
するようにしているみたいです)ため稀にエラーが発生したいたため、ローカル変数に格
納して RB_GC_GUARD() で保護するようにしています。 [ruby-core:47632] [Bug #7044]
テストは 1000 回累乗を繰り返しているんですけど GC.stress = true でも再現しない
でしょうか。 GC されたオブジェクトが再利用されて別のものが入らないとチケットの
報告された現象にはならないかもしれないですね。
