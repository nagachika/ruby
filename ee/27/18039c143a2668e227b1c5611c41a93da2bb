Windows 版で rubyw.exe を使って端末(コマンドプロンプト)を伴わないプロセスを使っ
ている時に、 dup2() で標準入出力用(0, 1, 2)の file descriptor を置き換えた時に
、起動した子プロセスにそれが伝播しないらしく、明示的に SetStdHandle() という関
数を呼んで File handle に対応づけているようです。 Windows の作法はよくわかりま
せんがこうしないと `cmd` などでコマンドの出力結果を取得できないようです。
[ruby-core:48542] [Bug #7239]
