rubygems の gem パッケージ作成時のビルド時刻に環境変数 SOURCE_DATE_EPOCH が指定されてたらそれを使うことで再現テストができるようにするのをメソッドに切り出しています。また環境変数に設定されてなかった時は現在時刻を使いますが、同時に環境変数にもそれを逆にセットするようにして以降の一貫性を保つようにしているようです。 https://github.com/rubygems/rubygems/issues/2290
