標準添付ライブラリ weakref の WeakMap のテストでオブジェクトを GC させるために
深くネストした frame の底でオブジェクトを確保しておく処理を assert_weak_include
というメソッドに切り出して再帰呼び出しするようにしています。確かこれって昔は深
く再帰するように書いてたけど、なにかの理由(たぶん一部の CI 環境でスタックが足り
なかったとか)で浅くしたんだったような気が。と思って検索したけどみあたらないので
記憶違いかなぁ。
