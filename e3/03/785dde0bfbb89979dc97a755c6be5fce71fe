Signal.trap でハンドラ部分に :IGNORE を渡して SIG_IGN を設定しようとした場合、
その直前に対象のシグナルを受信してシグナル通知用の queue にイベントが登録されて
いたら、取り出した時に SignalException が発生してしまうのを修正しています。ruby
では Signal.trap で登録されたシグナルのハンドラはメインスレッドで実行するように
、sigaction(3) などの C level のシグナルハンドラは queue にイベントを詰めて、メ
インスレッドがブロック処理時やタイマー切り替え時に処理するようになっていて、
SIG_IGN を設定する前にイベントハンドラが登録されていると、それを実行するための
イベントが queue に入っている可能性があり、それを pop すると SignalException が
発生してしまうので、IGNORE に設定されている時はそのイベントを無視するようにして
います。 [ruby-core:62565] [Bug #9835]
