3cfbfa9628435e3b09316a18c2db9e4f250fdd77 で ALLOC_N() でメモリ確保して返しっぱなしだったのでメモリリークしていたのを rb_alloc_tmp_buffer2() を使うようにしています。ああー、でもこれはこれで VALUE v がこの関数内のスコープで生きている間しか寿命がないから呼び元で GC が走ると解放されてしまうかもしれないなぁ。マクロにすればいいのかな。
