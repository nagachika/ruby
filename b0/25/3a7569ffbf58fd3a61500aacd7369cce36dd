struct timespec の扱いが苦痛なのでってことで rb_hrtime_t という整数型で nano
second 精度の時間を扱うための型を導入していいます。通常は 64bit で
MY_RUBY_BUILD_MAY_TIME_TRAVEL というマクロが定義されていたら(たぶん一種のジョー
クなのでしょう。今はこっちは通らないです) 128bit 整数として定義するようにしてい
ます。これを扱うための関数群も追加しています。いやー、結局 pthread_xxx() などの
引数にするために struct timespec との変換は必要だし本当にこれで読みやすくなって
るのか? という疑問は生じますが、この結果マシンスタックの消費量は減ってるそうで
す。 [ruby-core:88582] [Misc #15014]
