rb_hash() で hash 値の計算に goto を使って実質ループを書いていたのを while を使
って書くようにリファクタリングしています。
