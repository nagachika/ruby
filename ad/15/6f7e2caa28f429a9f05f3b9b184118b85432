拡張ライブラリ date の Date.allocate の定義を d_lite_s_alloc_simple() から d_lite_s_alloc_complex() に変更しています。また Date#initialize の定義は削除してかわりに Date.new メソッドを直接 date_s_civil() という関数で再定義するようにしています。コミットログによると Date を Marshal.dump したものをロードしようとした時に、その Date オブジェクトの内部表現が complex タイプだとうまく再構築する方法がないということに対応するためみたいです。Date は(条件はよく知らないのですが)内部表現に struct SimpleDateData と struct ComplexDateData と二種類あって、Date.allocate が simple のほうになってると complex タイプにする方法がないからとのこと。 https://github.com/ruby/date/issues/20
