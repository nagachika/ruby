Struct で作ったクラスの new メソッドの実装を rb_class_s_new() を改名した rb_class_new_instance_pass_kw() を利用するようにしています。 Struct で作ったクラスでキーワード引数の警告が出る問題の対応のようですが 2.8 以降キーワード引数の扱いがデフォルトで問題なくなったからかなぁ。バックポートについての注釈もありますが、要は Struct.new に keyword_init: false が指定されててもキーワード引数対応の関数を使って大丈夫ということかな。たくさん Pull Request の参照がついてます。 https://github.com/ruby/ruby/pull/2795 https://github.com/ruby/ruby/pull/2944 https://github.com/ruby/ruby/pull/3045 https://github.com/ruby/ruby/pull/3093 [Bug #16465] [Bug #16801]
