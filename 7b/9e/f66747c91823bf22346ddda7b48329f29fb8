定数への代入する C API rb_const_set() でネストした名前空間の定数への代入の時に Module/Class へ rb_funcall() で to_s メソッドを呼び出してたところを rb_tmp_class_path() を直接呼び出して名前空間のパスを得るようにしています。最適化かなと思いましたが 5e16857315bf55307c5fc887ca6f03bfa0630a93 の追加修正で、to_s メソッドが再定義されてたりした場合を考慮してということのようです。
