Windows で fsync() を pipe に対して呼ぶとブロックしてしまうそうなので、
GetFileType() で通常のファイルであることを確認して呼ぶようにしています。[DEL:ま
た Windows 以外の環境での fsync() のエラーチェックを追加しています。:DEL]
