r47386 で追加した has_privilege() を修正。 euid/egid との比較で検出するようにし
ています。実効IDが root だったり実IDと異なっていたら権限が変更されている(root
は特別扱いでしょうね)と判定し、また実効IDが保存(復帰)IDと異なっていた時も変更さ
れている(修正前は実IDと保存(復帰)ID を比較していましたが、保存IDは実IDと同じは
ずなので…あれ? この実IDと保存IDの比較の判定 uid と gid で結果が反対ですね。こ
れはいいのかな…。と思ってたら r47409 で gid のほうが修正されていました。
