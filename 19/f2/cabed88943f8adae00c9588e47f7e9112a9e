string.c の rb_str_aset() でも条件分岐を工夫して goto を廃止するリファクタリング。 https://github.com/ruby/ruby/pull/3247
