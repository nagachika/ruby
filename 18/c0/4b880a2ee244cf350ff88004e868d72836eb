pack.c でもビット演算結果に明示的なキャストを追加しています。
