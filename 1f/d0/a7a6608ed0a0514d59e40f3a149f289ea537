まず Makefile の変数 CPPFLAGS から -DLIBRUBY_LIBDIR オプションの指定は削り、
MJIT コンパイラ用のヘッダファイルの場所を実行時に検出するようにして、バイナリを
ビルドしたのとは別の位置にインストールして使う時も MJIT を有効にするようにして
いるようです。けど実行形式が自分の位置を知る方法って難しいんだよな確か……と
MJIT がパスを知るために使っている Ruby の定数 TMP_RUBY_PREFIX をセットしている
ところを調べてみると、LOAD_RELATIVE を使って libruby.so のパスから相対的に解決
するやつを使ってるのかな、多分。 [ruby-core:85390] [Bug #14445]
