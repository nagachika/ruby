Kernel#Integer は内部で未知のオブジェクトに対しては to_int が定義されていればそ
れを呼びますが、その結果が整数かどうかは判定していなかったため、おかしな to_int
(たとえば String を返す)を定義したオブジェクトを引数に渡すと Integer でないオブ
ジェクトを返してしまっていたので、結果が Integer でなかった場合は無視して to_i
の呼び出しに fallback するようにしています。 [ruby-core:85813] [Bug #14552]
