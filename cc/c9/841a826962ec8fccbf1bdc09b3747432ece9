dir.c と io.c でシステムエラー時に rb_sys_fail() などのかわりに errno を引数で
渡す rb_syserr_fail() を使うようにしています。途中で処理がはさまって errno が上
書きされることがあるのでローカル変数に退避しておいてそれを渡すようにしています
。
