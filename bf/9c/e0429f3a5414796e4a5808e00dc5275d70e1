r42666 で除算する数の設定に間違っていたのを修正しているのと、変数の宣言を必要な
ブロック内に移動する変更です。
