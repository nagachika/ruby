rb_vm_at_exit() で登録した Proc オブジェクトの実行順序は登録の逆順ですが、
at_exit で登録した手続きの中でさらに at_exit で登録した時の実行順序が、後から登
録したものが後回しにされるようになっていたので追加したものを先に実行するように
しています。[Bug #4400] [ruby-core:35237]
ネストした at_exit の実行のテストも追加されています。
