チケットをみると Integer#** の引数の絶対値が大きすぎる時に SEGV していた不具合
のようなのですが、Rational の乗算、除算に使う f_muldiv() で引数が Float の時に
対応するようにしています。けどここで T_FLOAT 型オブジェクトがくるパスあるのかな
。呼び元を確認してみた限りだとなさそうだけど……。また fix_pow() にも
rb_int_pow() が Float を返した時の対処を入れてる、ようにみえますが分岐の条件に
0 が入ってるのでこの条件文のbodyは実行されないようになってますね。消し忘れかな?
[ruby-core:89212] [Bug #15175]
[追記]nobuさんに教えてもらいました。 Integer#** が Rational を返す時に Rational
(1, Float::INFINITY) を返すことがあって、その時のための対処だったそうです。しか
しそもそもそのような時に rb_int_pow() は 0 を返すべきじゃない? というのが常時偽
になる条件で入れた処理だそうです。なるほど〜[/追記]
