タイマースレッドが割り込みを必要とする Thread も実行を待つ Thread もいなくなる
と polling モードをやめて無期限に select(2)/poll(2) で停止しようとするのですが
、割り込み中の Thread のリストのチェックの後に UNIX シグナル受信時のメインスレ
ッドへの割り込み処理をしていて、ここでリストが空でなくなった場合に本当は
polling モードでないといけないのに無期限停止モードになってしまいシグナル処理が
(メインスレッドがブロックする処理から抜けるまで)行なわれなくなる可能性があった
ので、メインスレッドの割り込みが行なわれる可能性のある処理の後であらためてリス
トをチェックするようにしています。 [ruby-dev:44999] [Bug #5757]
