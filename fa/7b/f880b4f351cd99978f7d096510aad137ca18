GC 中や GVL の解放中などでオブジェクト生成や Ruby の処理の呼び出しが行えないと
ころで、後で実行するために処理を登録しておく rb_postponed_job_register() などの
API で登録する postoned job の構造を single linked list から配列に変更していま
す。配列サイズは固定(MAX_POSTPONED_JOB という定数で 1024 に定義されています)に
していて、これを超えたらエラーを返すようにしています。
たぶん malloc 回数が頻繁になって GC 絡みでパフォーマンスとかの考慮した変更かと
思われます。今 postponed job は finalizer の実行のために使われていますがバッフ
ァサイズが 1024 で充分なのかというのがちょっと気になりますね。その呼び元では戻
り値を無視していますし。
