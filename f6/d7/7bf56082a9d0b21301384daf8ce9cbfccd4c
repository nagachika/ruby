r51832 の追加修正でしょうか。 Windows 版の dup2() の実装 rb_w32_dup2() で dup2
() のエラーチェックを追加しているのと、msvcrt の dup2() は newfd ではなくて 0
を返すことがあるそうで、戻り値ではなく newfd のほうを返すようにしています。
