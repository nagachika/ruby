compile_array() の配列リテラルのコンパイルの方針についての巨大な配列リテラルのための工夫とかをコメントでわかりやすく解説してくれています。そういえばこういう工夫あったなぁ。さらに要素がコンパイル時に決定するリテラルだった場合に newarray を使わず ISeq 内に直接配列オブジェクトを埋め込んで dup するだけにする最適化は、静的でない要素(この最適化ができない要素)より前だけに使われてましたが、後ろ側にも適用できるのでそうするようにしています。
