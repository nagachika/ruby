File.open に File::TMPFILE フラグを指定した時に Errno::EOPNOTSUPP という例外が
発生することがある(O_TMPFILE がサポートされていない時)ようで rescue して skip
するようにしています。
