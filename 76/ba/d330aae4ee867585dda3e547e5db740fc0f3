encoding.c で realloc(3) を直接呼んでいたところをエラーチェック済みの xrealloc() を使うようにしています。例外発生になると思うんだけどいいのかな。これまで一応 -1 を return することでエラーを表してて、それをチェックしてるコードも存在するけど…。また間接的にこの関数の呼び元である enc_replicate_with_index() で戻り値チェックでエラー検出した時に rb_raise() で例外発生させるようにしています。まあこれは xrealloc() のエラー以外で戻り値によるエラーを返す箇所があるのでその場合は通る可能性があるのでいいのですが。
