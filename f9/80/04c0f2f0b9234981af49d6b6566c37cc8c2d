rb_ident_hash() で flonum のdouble を st_data_t にキャストしているところがあり
ましたが、これは未定義挙動なので共用体を使ってバイナリ表現をそのまま利用するよ
うに変更しています。たぶん hash 値が変わるんだと思いますが ruby レベルに見える
ものではないと思うので非互換はないかな、たぶん……。
