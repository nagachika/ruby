T_ZOMBIE 型のオブジェクトの RVALUE スロットを埋めて管理するために struct
RZombie という型を導入しています。これには linked list を構成するためのポインタ
と、解放関数ポインタとその引数が格納されています。うーんなるほど、元のオブジェ
クトの flags に T_ZOMBIE をセットする時にリストは free の型を利用しつつ解放関数
などは data を利用する中途半端な状態だったので Zombie 状態専用の型にしておくん
ですね。わかりやすくなりました。また Zombie 状態のオブジェクト数をカウントする
ようにしています。最近オブジェクトの数を数えるのが流行みたいですね。
