Ractor.make_shareable というメソッドを追加しています。引数に渡されたオブジェクトをその参照先も含めて struct RBasic::flags のフラグをチェックして Ractor 間で共有可能にするため freeze するようにしています。もちろん対応できないオブジェクトの(への参照を含んでいる)場合は例外が発生するようにしていて、基本的には Ractor 間の参照可能にするために再帰的な freeze をするメソッドという感じですかね。また RUBY_TYPED_FROZEN_SHAREABLE という定数も追加されていて、拡張ライブラリ で T_DATA 型のオブジェクトを定義している時は対応してればこのフラグを立てておくようにしましょうということです。
