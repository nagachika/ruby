メソッドッキャッシュの無効化をクラスの継承関係などを元にした hierarchy method
cache invalidation というのを実装しています。これまでメソッドキャッシュはメソッ
ド定義をしたりメソッドを持つ Class/Module が GC で回収されるなどの時に VM が持
つバージョンというのをインクリメントして、これが更新されると全体でメソッドキャ
ッシュが無効化されて再取得するようになっていたため、無名モジュールを使い捨てて
いたり一時的なオブジェクトに Module を extend して使ったり(特異クラスが発生す
る)とメタプログラミングを多用していると頻繁にメソッドキャッシュのクリアが発生し
て遅くなっていたのが、その影響が限定的になるかもしれません。良く実装をみてない
のでどういう範囲でクリアされるようになるのかよくわかってませんけど。しかしこれ
はとても魅力的な変更ですね。実用的なアプリケーションでどのくらい影響があるんで
しょうか。 [ruby-core:55053] [Feature #8426]
