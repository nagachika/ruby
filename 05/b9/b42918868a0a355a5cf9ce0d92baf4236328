文字列のエンコーディングの互換性のチェックのための関数に rb_enc_check_str() と
いうのを追加して、引数が T_STRING か T_REGEXP だということがわかっている時にチ
ェックやオブジェクトの変換の処理をスキップして直接 encindex を取得する
enc_get_index_str() という関数を利用するようにしています。これは TinySegmenter
という日本語の分かち書きのライブラリのベンチマークの Ruby 版を高速化するために
入れた最適化みたいです。
