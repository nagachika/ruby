signal.c の check_stack_overflow() で現在の Thread を取得するのに GET_THREAD()
を呼んでいたのを、直接 ruby_current_thread を参照するようにしています。ここで関
数を呼ぶとさらにマシンスタックの push が行なわれてしまいデッドロックが発生する
のを防ぐためとのこと。
というか GET_THREAD() ってマクロだと思ってましたが vm_core.h で inline 関数とし
て定義されていました。ああ、r37293 で C 実装のメソッドを呼ぶ時に VM Frame を積
まないようにする最適化(デフォルトでは無効になってる)のために変更されてたのでし
た。さすがにここまで憶えてない…。そしてこれは 2.0.0 でも 2.1 でも同様ですね。
