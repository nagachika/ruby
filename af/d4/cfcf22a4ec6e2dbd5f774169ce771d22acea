tool/lib/colorize.rb で tput というコマンドで端末の terminfo の情報を得るのに smso というサブコマンドを使ってたのを so というのも試すようにしています。環境によっては smso がサポートされてないとからしい。
