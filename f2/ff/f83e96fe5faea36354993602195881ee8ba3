rb_barrier_wait() の返り値が true(取得成功)、false(失敗) だけだったのを、false
(Barrier は破棄済み待っている Thread もいない)、nil (破棄済みだけどまだ待ってる
Thread がいる、または再帰的に呼び出されている)と区別できるようにしています。そ
して load_lock() で取得失敗した時に自分が最後の Thread かどうか判定してテーブル
から Barrier のエントリを削除するようにしてテーブルにゴミが残るのを防いでいます
。
