r31747 でバッファへの読み込みのループから break したあとにきちんと return する
ようにしています。
