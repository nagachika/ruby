Windows 環境では Socket を開いてから system() などで子プロセスを起動するとデフ
ォルトで子プロセスに継承されてしまって、親プロセスで閉じてもポートが使われたま
まになってしまう不具合を修正しています。通常 ruby で開いた fd は close-on-exec
フラグが立てられてこの問題が起きないようになっているのですが、Windows でソケッ
トの作成をしていたところでこれに対応する処理が漏れていたところがあったようで、
SetHandleInformation() という API を利用して close-on-exec と同様のフラグセット
を行っているようです。 [ruby-core:61754] [Bug #9688]
