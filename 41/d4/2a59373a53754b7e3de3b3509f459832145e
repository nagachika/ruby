r44297 のさらに追加修正という感じですが configure で --with-opt-dir で指定した
ディレクトリが LIBPATHFLAG と RPATHFLAG という変数がまだ初期化されていないため
LDFLAGS と DLDFLAGS に反映されないという不具合があったため、これらのフラグへの
反映をオプションの処理する場所から必要な変数が揃った後に移動しています。
configure は「ちょっと場所を移動しただけ」という変更も油断できないですね。C も
ですけど、そっちはコンパイルエラーや警告がある程度教えてくれますからねぇ。
[ruby-dev:47868] [Bug #9317]
