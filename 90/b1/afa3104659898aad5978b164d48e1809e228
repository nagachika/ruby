ここからキーワード引数の追加のためのコミットが続きます。 [ruby-core:40290]
[Feature #5474]
まずパーサ部分の lambda のブロックを構文解析して AST(抽象構文木)を作る時に、ブ
ロックパラメータ部分を読んだ時に一旦 NODE を作っておいて、lambda のブロック本体
をパースした時に改めてその NODE の内容(子NODE)を代入しているというやりかたにな
っていたのを、ブロックのパース後にまとめて NODE を生成するようにするというリフ
ァクタリングです。 CRuby の AST は三分木になっていて、それぞれ子を3つまで持てま
す。これまで NODE_LAMBDA は 1つ目と2つ目の子にノードの参照を持っていたのですが
、1つ目の参照はこの古い方法で一時的に格納していただけのようで、新しい方式では1
つ目の子は持たないようになっています(元々持っていたNODEは 2つ目のノードの子だっ
たのでなくなったわけではない)。
