ObjectSpace.memsize_of で T_OBJECT 型オブジェクトのインスタンス変数が埋め込みじゃなくてヒープ利用時に as.heap.ivptr の NULL チェックをしていましたが、flags で埋め込みじゃないことを確認した場合常に使ってるはずなので余分なチェックを削っています。
