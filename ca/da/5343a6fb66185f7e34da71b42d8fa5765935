st.c でエントリ数が少なくて配列内にキーと値のペアを順に並べるだけの状態の時の基
本的な操作をマクロとして切り出しています。
が、unpack_entries() で pack されたものをあらためて pack されてないテーブルに追
加するところで do_hash() の呼び出しがコメントアウトされているのですがこれはいい
のかなぁ。[追記] pack されるのはハッシュの種類が numhash の時だけで、この時のハ
ッシュ関数はキーをそのまま使うので良いようでした。ただ do_hash() のキャストが違
っていてその結果CPUアーキテクチャによっては差があったのでそれは翌日修正されてい
ます[/追記]
