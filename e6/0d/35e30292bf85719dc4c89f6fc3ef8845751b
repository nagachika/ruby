Windows 版の rb_freopen() の実装でパスの変換に使うバッファを ALLOCV_N() を使っ
て小さいサイズならスタック上に確保するようにしています。また変換に
rb_w32_mbstr_to_wstr() を使っていたのを MultiByteToWideChar() を直接呼び出すよ
うに修正しています。 NUL文字終端していない文字列の変換で失敗することがあったみ
たいです。 [ruby-core:69780] [Bug #11320]
