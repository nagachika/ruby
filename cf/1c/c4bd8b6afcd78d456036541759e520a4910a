ext/zlib/zlib.c で sizeof() の返り値を誤って int として扱っていたので、#define
でキャスト付きの定義で上書きしてしまっています。
