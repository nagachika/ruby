文字列リテラル内の #{} による埋め込みなどで用いられる VM の命令 concatstrings
で Encoding の処理を変更して後の文字列の Encoding が US-ASCII 以外で前の文字列
の Encoding が US-ASCII だったら後の文字列の Encoding を保持するようにしていま
す。また "#{}" のように文字列リテラルの先頭に埋め込みがあった場合に先頭の空文字
列を作らないように最適化しています。 [ruby-core:70930] [Bug #11556]
r51820 で先頭に埋め込みがあった時に script encoding にならなかった問題を修正す
るために先頭の空文字を入れるようにしたのをやめて、後の文字列の Encoding を優先
するようにしたということですかね。
