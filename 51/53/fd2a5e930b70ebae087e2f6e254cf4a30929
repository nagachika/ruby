r33507 でファイルディスクリプタにはデフォルトで FD_CLOEXEC をセットするようにし
たところ Solaris では grantpt(3) が内部でヘルパープログラムを起動するため、対象
の fd に CLOEXEC がセットされているとヘルパープログラムでその fd が閉じられてし
まってエラーになるそうです。そのため Solaris では rb_fd_set_cloexec() の呼び出
しを grantpt の後にずらすようにしています。 [ruby-dev:44688] [Bug #5475]
[DEL:rb_fd_set_cloexec() の部分だけ #ifdef で囲んでもいいような気がするのですが
posix_openpt() から grantpt() までの一連の関数呼び出しを #ifdef .. #else で分け
ているのはなぜだろう。:DEL] [追記] すみません、これはわたしの読み間違いです。
rb_fd_cloexec() の呼び出しを消してるんじゃなくて位置をずらしているんですね。[/
追記]
