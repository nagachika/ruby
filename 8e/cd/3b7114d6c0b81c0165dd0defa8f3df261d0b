VM のプロセス終了時に全ての Thread を停止させている時のために Thead の終了時に
main thread だけが残っている状態になると main thread に割り込みをかけていたので
すが、拡張ライブラリからはこの割り込みが VM 終了によるもの(従って処理をやめるべ
き)なのか、単に別の Thread が終了した通知なのか区別がつかなくてうまく処理できな
い(再度ブロックする処理を実行すると終了時にブロックする可能性がある)という問題
を修正するため、Thread 終了時の割り込みに main_th->status をチェックするように
しています。 [ruby-dev:49044] [Bug #11237] https://github.com/ruby/ruby/pull/
898
