オブジェクト(VALUE)の型をチェックする時に TYPE() マクロで型を取り出して
T_OBJECT, T_ARRAY などと比較しているようなコードを RB_TYPE_P() マクロを利用する
ように変更しています。 RB_TYPE_P() は即値の型の場合のショートカットがあってコン
パイラの最適化がうまいことしてくれるとより高速なコードにしてくれるそうです。
