r54237 の再修正で数値の型による分岐の外に演算の一部を括り出しています。
