test/unit の prepare_syntax_check で省略可能引数のデフォルト値を nil にしてメソッド本体でデフォルト値をセットするようにしています。第3引数の mesg のデフォルト値が第2引数の fname に依存しているので、引数の評価の順序に依存しないようにするためか、fname は省略して mesg のみ指定したい時にできなかったからかな。
