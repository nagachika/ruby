sprintf の実装で潜在的オーバフローの修正のためローカル変数の型を int から long
へ変更しています。
