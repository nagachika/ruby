拡張ライブラリ objspace で提供していた ObjectSpace.memsize_of の実装を gc.c に
移動して Old の世代に昇格したオブジェクトの消費メモリを概算するプロファイラを追
加しています。 memsize_of で完全に利用しているメモリ全てを報告しない場合もある
とか T_DATA 型のオブジェクトは memsize_of 用の関数に問題があることがあるなどで
全ての使用メモリを正確に知ることができるわけではないそうですが、これで旧世代の
オブジェクトのメモリ使用量がしきい値を越えたら Major GC を実施するようにするこ
とで 3世代 RGenGC が対象としているテストケースの対策として別の案として入れてい
るみたいです。しきい値を制御する環境変数の導入もそれらしいコードがありますがコ
メントアウトされています。
