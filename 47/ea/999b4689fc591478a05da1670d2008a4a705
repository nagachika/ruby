拡張ライブラリ coverage に oneshot mode というのを追加しています。
Coverage.start メソッドのオプションに :oneshot_lines を追加して、これが指定され
た時はある行が 1回以上実行されたかどうかだけ記録して回数は記録しないようにして
います。つまり1度実行されると ISeq のフラグが落とされるのでパフォーマンスへ与え
る影響が小さくてすむということですね。なるほどー。
また Coverage.result にも :stop と :clear というオプションを追加して、coverage
収集の停止やリセットを抑制できるようにしています。 [ruby-core:88628] [Feature #
15022]
