456586bb234915107da255d2944f620a7dd7048b の再修正。 struct timeval の変数の宣言を外のブロックに出して、肝心の rb_wait_for_single_fd() で読み込み可能になるまで待つようにする処理を追加しています。
