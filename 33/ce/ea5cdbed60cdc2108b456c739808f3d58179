str_to_encindex() から String 型のオブジェクトで指定されたエンコーディングのイ
ンデックス番号を返す処理を str_find_encindex() として切り出して、
rb_find_encoding() という API を追加。これを利用して IO#set_encoding に引数を2
つ指定した時に不正なエンコーディング名が指定された時にはエラーになっていたのを
、警告を出力してデフォルトのエンコーディングにするように修正しています。
[ruby-core:40726] [Bug #5567]
