scanf のテストで開いたファイルや pipe を ensure で閉じるようにしてたのをブロックを渡したメソッド呼び出しを使うようにして明示的な close を不要にしています。 元の File.new というのに古さを感じますね。
