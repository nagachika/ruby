Array#join の結果を格納するための文字列オブジェクトを生成するのに rb_str_buf_new() を使ってましたが、これは指定のサイズが小さくても最低でも 127 bytes はヒープからメモリを確保してしまうので、rb_str_new() で capa を必要なサイズを指定して生成してから rb_str_set_len() で len をセットするようにして、不要なメモリ確保を抑制するようにしています。
