gc_mark_stacked_objects() で mark_stack に入っていたオブジェクトが mark 済みで
なかったら rb_bug() で異常終了するようにしていたのですが、これを
RGENGC_CHECK_MODE が 1以上の時のみ停止するように条件を緩和しています(つまり通常
は落ちないように)。
mark_stack って mark してそこからの参照を再帰的に mark するために入れておくスタ
ックだと思うのですが、rb_bug() のメッセージをみると infant (まだ GC を生き延び
たことがない)のにマークされていない、というように書かれていてこれはどういうこと
なんだろう……。最近の GC の進化に記憶が追い付いていません。
