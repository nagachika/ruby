RubyGems の Gem::Util.popen で、IO.popen で生成した IO を close せずに読みっぱ
なしで子プロセスが zombie 化していたのを修正しています。また 1.8 向けの処理で子
プロセスの終了を待つ前に read して pipe 経由の子プロセスの出力を読むようにして
います。 pipe のバッファよりも出力が多い時に子プロセスが書き込みでブロックする
とプロセスが終了しないのに待ってしまってデッドロック状態に陥いるようになってい
たので修正しています。
