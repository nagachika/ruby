objspace_malloc_increase() で garbage_collect_with_gvl() を起動する可能性のある
パスには Ruby の Thread になっているネイティブスレッド以外の、拡張ライブラリか
ら起動されたスレッドなどでは入らないようにしています。ここにはそのような野良ス
レッド(造語です)も xmalloc() の呼び出しから入ってくる可能性があるので、その時は
あきらめてメモリ確保だけさせてあげるようにするみたいです。 FATAL で異常終了しよ
うかーというような提案もあったようですけど、制限は緩いほうに倒したようです。
[ruby-core:61519]
