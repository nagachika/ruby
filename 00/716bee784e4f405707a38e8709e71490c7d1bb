r62145 のさらに追加修正。早めに return するように追加した条件が常に真になってた
ので判定を修正しています。
