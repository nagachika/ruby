GC のパラメータを環境変数で切り替えるというパッチを取り込んでいます。が誤操作で
最近のコミットを巻き戻してしまっているそうで差分がたいへんなことになっています
。実際に入った内容は以下の diff で観ることができます。github 便利。
https://github.com/ruby/ruby/compare/
c414d861c109ff546e2bc8c7264859907d6e0f76...1df42597d15416357a20bd68700ce1a2d245e8bb
で RUBY_GC_MALLOC_LIMIT、RUBY_HEAP_MIN_SLOTS、RUBY_FREE_MIN といった環境変数で
GC の動作に関係するパラメータを設定できるようです。でもいきなり printf() とかし
ちゃうので本番で使うような感じじゃないですね。元の gist にはこの printf() 等は
ないのでもしかしたら消し忘れかも。
パラメータの内容は Ruby の GC について知っていればだいたい想像が付くと思います
。RUBY_FREE_MIN は free スロットがどのくらい減ってきたら新しいヒープを確保する
かのパラメータです。
