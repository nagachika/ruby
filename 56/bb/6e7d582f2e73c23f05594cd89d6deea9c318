rb_execution_context_t の mark 関数と update(GC.compact による参照の移動の追随)関数で現在の ep がローカル変数をもつフレームじゃなかった時に遡って VM_ENV_LOCAL_P() が真になるまで辿ってましたが現在の ep のみ処理するようにしています。ここでループしなくても control frame が全て処理されるので冗長だったということみたいです。というかコミットログによるとむしろこれで Rails のテストの SEGV が修正されるとのことで、むしろ辿っちゃだめだったみたいですね。なんでだろう。
