2b2821acd39530c6c786e34f304e9e018a31e5c4 と同様に Array#join で変換のために to_str を呼び出した後で配列のサイズも変化している可能性があるので再度チェックするようにしています。
