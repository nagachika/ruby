ruby のプロセス終了時の処理 ruby_finalize_0() および ruby_finalize_1() をそれぞれ rb_ec_teardown() と rb_ec_finalize() と改名して rb_execution_context_t を引数に受け取るようにして中で GET_EC() を使うのを避けるようにリファクタリングしています。また rb_trap_exit() も rb_vm_trap_exit() と改名し引数に rb_vm_t を受け取るようにしています。そして rb_exec_end_proc()、rb_gc_call_finalizer_at_exit()、rb_trap_exit()、rb_clear_trace_func() の宣言は include/ruby/backward.h に移動して deprecated にマークしています。
