vm_declare_class() で作成した Class に rb_define_alloc_func() でインスタンス作成時の allocate 用の関数を指定しておくようにしています。ベンチマークと共に追加れているのでパフォーマンス改善が目的のようです。Ruby でクラス定義をする時には問題ないけど拡張ライブラリで Ruby で定義されたクラスを継承してなにかする時など非互換になる可能性があるとコミットログに書かれています。 https://github.com/ruby/ruby/pull/3764
