thread.c の lock_func() while の条件部で少しトリッキーな書き方がされていたとこ
ろを整理するリファクタリングをしています。
