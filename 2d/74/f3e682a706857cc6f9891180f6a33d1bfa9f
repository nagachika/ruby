Hash#[], update などの実装で要素の追加をする時に st_update() を利用して要素の検
索と追加を一度に実行するようにリファクタリングしています。高速化が目的と思われ
ます。その Hash オブジェクトで each などによるイテレーション中の場合は新規追加
は例外発生させるためコールバック関数は2種類用意するようにマクロを使って処理をま
とめています。
