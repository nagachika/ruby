同じく 2a6457b5b7d67378528235cee7b9cb93fed00204 で追加した rb_funcallv_with_cc() の宣言を include/ruby/ruby.h から消して internal.h に移動して、インタプリタ内部の実装でのみ使えるようにして公開 C API にはしないようにしています。見逃してたけど 2a6457b5b7d67378528235cee7b9cb93fed00204 では rb_funcallv() をマクロ定義して常に rb_funcallv_with_cc() を使うように最適化されてました。で内部でしか使わないので内部の構造体 struct rb_call_cache をopaque にする必要はないので直接ポインタを受け取るようにして関数内で ZALLOC() でキャッシュの領域を確保するのは避けています。
