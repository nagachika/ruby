引数なしの sleep がシグナルの割り込みで(メインスレッドで sleep している時に限
り)メソッドから返るようになっていたのを、シグナルでは返らないようにしています。
[ruby-dev:42601] [Bug #4072]
メインスレッドで sleep している時の挙動が変化してしまうことになります。しかし元
の動作にも不安定なところがあって、現在 C レベルのシグナルハンドラは全てのスレッ
ドが実行する可能性があり、Mac OS X ではシグナルで割り込まれた時に sleep の実体
である pthread_cond_timedwait() が返り値0で抜けてきてしまう(spurious wakeup)。
つまりメインスレッド以外でも sleep は抜ける可能性がありそれを避けるために修正し
ています。
