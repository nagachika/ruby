拡張ライブラリ openssl で BN_xxxx() という関数群がドキュメント上はエラー時に 0 を返すと書かれているけど実際には古い(といってもちょっと前くらい?)バージョンや LibreSSL では -1 を返すようになってるので、どちらが返ってきてもエラーとみなすように <= 0 でチェックするようにしています。
