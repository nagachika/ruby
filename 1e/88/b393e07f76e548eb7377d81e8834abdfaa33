スレッドの切り替え時に GC でマークするためにマシンスタックの情報を保存する
RB_GC_SAVE_MACHINE_CONTEXT で、スタックポインタを保存する SET_MACHINE_STACK_END
() の実行を、その他の情報を保存する rb_gc_save_machine_context() の中に入れてい
ます。関数の内外でスタックポインタが違うはずで、関数呼び出しでレジスタの値をス
タックにのせた上で変更された結果が保存されて、スタックポインタが
rb_gc_save_machine_context() の外側までのものだとその部分が保護されない可能性が
あるということかと思います。
