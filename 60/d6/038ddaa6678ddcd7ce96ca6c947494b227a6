r37993 の Refinement の変更を再度適用しています。 r37993 で SEGV が発生していた
のはマシンスタック上に作られた method entry を rb_callinfo_t::me に保持させてし
まっているところがあって不正なメモリアクセスになっていたためだったとのこと。今
回は VM_METHOD_TYPE_REFINED 型の method entry はコピー元の method entry のコピ
ーを保持するようにして、また Thread のマーク時に cfp->klass をマークするように
しています。その他の変更は r37993 の時のコメントを参照してください。この時コミ
ットラッシュだったのであまり読んでないですけど……。今日もコミットログだけみて
書いてるので内容はいずれ読みたいところです。
