6eb7c663c665c633bdeae185d45e78832e672acc の標準添付ライブラリ irb の show_source の実装変更で各行のスクリプトの文字列を join で連結してたのをバッファとして使う String オブジェクトを作っておいてそこに破壊的に追記していくことで表示用の文字列を生成するようにしています。
