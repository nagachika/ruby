Marshal.dump は特異メソッドを持つオブジェクトは dump できないのですが、Module#
prepend で特異クラスに対して別のモジュールを prepend するとそのオブジェクトが
dump できてしまっていたので、RCLASS_ORIGIN() を使って prepend で挿入された(そし
てメソッドテーブルが移植された) IClass のほうを検査するようにしています。
prepend 回りはいろいろ出てきますね。
なお特異クラスに include した(つまり Object#extend した)オブジェクトは dump で
きます。dump できないのはそのオブジェクトの特異クラスに直接メソッドが追加されて
いる場合です。これ、わたしも勘違いして憶えてました。 [ruby-core:53206] [Bug #
8043]
