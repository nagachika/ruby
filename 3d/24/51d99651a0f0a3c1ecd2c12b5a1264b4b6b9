現在の trunk と 1.9.3 は環境変数から GC のパラメータを設定する機能がありますが
、そのうち RUBY_HEAP_MIN_SLOTS を変更してヒープスロットの数を拡張した場合、その
前に初期値で確保したヒープが既に拡張済みだとヒープスロットの空きを意味する変数
が設定されていて、これを 0 クリアしていなかったのでその後の処理で不正メモリアク
セスを起こして SEGV などを発生させる不具合がありました。パラメータの設定でヒー
プを拡張してスロットを埋めた時に heaps_inc を 0 にリセットするようにしています
。 [ruby-core:39777] [Bug #5380]
またそのテストのために assert_normal_exit に子プロセスに環境変数を渡すオプショ
ン :child_env を追加しています。
