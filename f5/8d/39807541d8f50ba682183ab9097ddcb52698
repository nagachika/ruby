標準ライブラリ net/http で Net::HTTP::Request で Accept-Encoding ヘッダが指定さ
れていなかった時に Response で Content-Encoding を解釈せずそのまま返すようにし
ているようです。圧縮されていた時など解凍した結果を返さずに、ライブラリの利用側
で処理させるそうです。これは 1.8 および 1.9 系との互換性のためとのことです。
多分 r36473 の変更で挙動が変化してしまった部分をケアしているんだと思います。こ
の時の ruby-trunk-changes のコメントと照し合わせると、デフォルトで Accept
-Encoding ヘッダには deflate, gzip が指定されるようにしている(そしてその時は自
動的に解凍した結果が返される)のだけど、明示的に Accept-Encoding を指定した場合
には解釈せずに返すということのようですね。 [ruby-core:52134] [Bug #7831]
