SecureRandom#random_bytes で /dev/urandom から読み込みしようとするところで IO#
readpartial を使っていたのを IO#read にしています。IO#readpartial は IO オブジ
ェクトの読み込みバッファか、その fd に読み込める入力があればそれを読めるだけ読
んで返す(EOF なら nil を返す)のですが、読めるデータがないとブロックするというな
んか微妙なメソッドなのですが、/dev/urandom は普通要求されたサイズを必ず読めるデ
バイスファイルなので特に readpartial を使っている意味はありません。多分 /dev/
urandom が実は期待したデバイスファイルじゃなくて名前付きパイプだとかなんかそん
なような罠があった時には意味があるのかもしれませんが、どのみち読めるデータがな
い時はブロックするので不完全です。
