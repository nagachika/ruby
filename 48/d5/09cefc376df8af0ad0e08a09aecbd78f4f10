Kernel#=== メソッドの実装の関数を case_equal() という rb_equal() を呼び出すだけの関数に変更して、rb_equal() のコメントに VALUE 値を直接比較する最適化が行なわれるために、この C API を直接呼び出すと Float::NAN 同士の比較が真になってしまうなどのちょっと equal?  メソッドとは異なる結果になる場合があるという注意を追記しています。
