b00f280d4b9569e7153365d7e1c522b3d6b3c6cf のさらにリファクタリング。無名のクラスの配下で定義されたクラスとかの名前を、所属している名前空間の(なんて言えばいいんだろ。親というと継承関係になってしまうから上クラス?) Module/Class が後から定数に代入された時にあらためて正式な名前として登録する時に再帰的に伝播させる処理で使っている関数名を変更して、隠しインスタンス変数への設定処理をコールバック関数内に移動しています。 [ruby-core:92253] [Feature #15765]
