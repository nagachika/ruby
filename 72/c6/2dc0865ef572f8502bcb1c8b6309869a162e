同じく win32ole のテストで assert_match_with_retries を使っていたところで
message_loop というメソッドにインスタンス変数名を指定することで待つという方法が
あったみたいなのでそれを使うようにしています。
