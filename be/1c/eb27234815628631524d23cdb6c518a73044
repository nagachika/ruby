rb_scan_args() のマクロ定義で fmt"\0\0\0\0\0\0" と NUL 文字の文字列と連結してい
たのをやめています。 fmt が文字列リテラルじゃない時にコンパイルエラーになるから
とのこと。__builtin_constant_p() で fmt が定数なのは確認しているけど、分岐では
ないから引数は先に評価されてしまうということかな。また rb_scan_args_verify() で
_Pragma() を使って部分的に警告を抑制するようにしています。またマクロ群を inline
関数に変換しています。ちょっと読みやすくなったかも。
