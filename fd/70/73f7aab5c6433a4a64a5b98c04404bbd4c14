r46727 で fstring のテーブルで sweep 予定の文字列を rb_gc_resurrect() で復活し
ないで新規追加するようにした変更の追加で、sweep 予定のオブジェクトはテーブルか
ら削除しておくようにしています。こうしておかないとまたゴミオブジェクトがみつか
って重複した追加がされてしまい可能性があったのではないかと思います。また struct
RSymbol::fstr を 0 クリアしておいて、sweep 時のテーブルからの削除の必要の有無を
判定できるようにしています。
あと dsymbol_alloc() で global_symbols.minor_marked を 0 クリアしていますがこれ
との関係はよくわかりません。新規に symbol を追加した時に次の minor mark でマー
クやりなおすようにしています。多分これは resurrect やめたのとは独立して、symbol
追加後にはマークしなおしが元々必要だったのではないかな…。
