r38225 で導入した rb_uninterruptible() という関数(Kernel#p の実行中に複数の引数の表示のあいだ割り込みを pending させるために追加されたもの)で処理の終了後に RUBY_VM_CHECK_INTS() で割り込みチェックするポイントを追加しています。 inspect の実行などに時間がかかるようにした時にメインスレッドの終了による VM 全体の終了の割り込みが効かないことがあったそうです。
