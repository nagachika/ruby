r51660 で組み込みクラスになった Queue に Queue#close メソッドを追加して、Queue
を閉じることができるようにしています。閉じた Queue が空になると Queue#deq は
nil を返すか、引数に true を渡すとかわりに例外 ClosedQueueError を発生させるよ
うになっています。 [ruby-core:66843] [Feature #10600]
例外を使うかどうかが Queue#close の引数で決まるのはちょっと妙な気がしますね。
Queue#deq/pop にキーワード引数を追加したほうが良いような…。あとライブラリとし
ても容易に実装できると思いますが、close を N回で本当に閉じるという機能があると
producer-consumer モデルで複数の producer の終了を検出するのが楽になりますね。
っていうのをチケットに書けってことですね、書きました。
