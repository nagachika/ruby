set_trace_func の現在トレース中かどうかの状態を格納する rb_vm_t::trace_running
を 0/1 で保持するのではなくてカウンタとして扱うようにしています。イベントフック
の実行が再入したりした時のことを考慮しているのかと思います。 [ruby-dev:46763]
[Bug #7589]
