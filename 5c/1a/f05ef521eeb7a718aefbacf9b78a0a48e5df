defs/gmake.mk という make のテストに関する依存関係を記述したファイルを追加して
GNUmakefile から include するようにしています。 make test などした時に適切に再
ビルドするようにしているのだと思います。 Makefile の変数展開内で使える関数が駆
使されていて、あまりちゃんと処理を追っていませんけど。
[追記] make -j で main や all と test や test-all などを同時に明示的に指定して
並列ビルドした時に拡張ライブラリなどのビルド途中でテストが動いてしまわないよう
にしているんだそうです。なるほど。[/追記]
