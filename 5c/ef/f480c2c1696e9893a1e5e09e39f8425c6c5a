拡張ライブラリ ripper の Ripper::Lexer::Elem に message という属性を追加して Ripper::Lexer#scan というメソッドで lexer の結果とエラー時のエラー内容を同時に返せるようにして irb の シンタックスハイライトでこれを利用するようにして、irb 側で独自に拡張していたのを取り込むようにしています。
