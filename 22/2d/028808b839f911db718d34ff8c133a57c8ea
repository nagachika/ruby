eval_error.c の error_print() で例外や例外以外の内部的なエラー等のメッセージを
出力するところで TH_EXEC_TAG() で setjmp() を呼ぶ回数を減らしています。ローカル
変数を Qundef で初期化しておいてその状態をチェックすることで、どこまで処理が進
んでいたかを判定できるようにしているのがミソかと思います。
