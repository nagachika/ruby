Sync_m#sync_lock で待ち中に例外などで抜ける時に待っている Thread を管理している
インスタンス変数の変更が行なわれない不具合があったので ensure 節で後始末をする
ようにしています。また共有ロックから排他ロックへの昇格をしようとした時の管理に
も間違いがあったようなのでその修正もあります。 [ruby-dev:44521] [Bug #5355]
