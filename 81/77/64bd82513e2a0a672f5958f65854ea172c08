609de71f043e8ba34f22b9993e444e2e5bb05709 でブロック内の rescue と ensure 両方ある時に ensure 内で発生した例外が並列する rescue で捕捉されちゃう不具合修正をした時に、実際には不要な時にも ensure 用のコードブロックを追加してしまっていたそうなので条件をより詳しくチェックするようにしています。
