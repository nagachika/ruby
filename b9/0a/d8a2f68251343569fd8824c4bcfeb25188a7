標準添付ライブラリ net でソケットの読み書き可能になるのを待つところで IO.select
ではなく拡張ライブラリ io/wait の IO#wait_readable と IO#wait_writable を利用す
るように書きかえています。 io/wait は Linux では ppoll(2) を利用しているため、
開いている fd 数が多い時のメモリ確保量を抑えてパフォーマンスを向上するのが狙い
ということで、その効果が [ruby-core:35572] で報告されています。依存関係が……と
思いましたが io/wait は Socket をサポートしている環境ではどこでもビルドできると
のことで。なるほど。
