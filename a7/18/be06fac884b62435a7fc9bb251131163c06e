r47655 での変更でメソッドの引数とその中でのメソッド呼び出しのブロックパラメータ
が同じ名前だったのを修正しています。また tempfile のテストで ConditionVariable
が必要だそうで require "thread" を追加しています。
