関数マクロ FIX2ULONG() を NUM2LONG() を使って unsigned long にキャストするだけ
に変更しています。あーこのマクロでは負値をチェックしたりはされないんですね。
