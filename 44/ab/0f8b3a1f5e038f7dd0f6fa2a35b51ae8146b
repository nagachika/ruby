irb で文字列リテラル内の #{} で式を埋め込んでいるところのパースで、改行後に継続
の判定のために [] や {} の対応をチェックしているところで対応のチェック条件が間
違っていたのを修正しています。テストがないので影響の度合いはよくわかりませんが
、どうも
irb(main):001:0> "#{ {foo: 42
irb(main):002:1> }
irb(main):003:0" }
irb(main):004:0" "
=> "{:foo=>42}\n"
となっていたのが
irb(main):001:0> "#{ {foo: 42
irb(main):002:1> }
irb(main):003:0> }
irb(main):004:0" "
=> "{:foo=>42}\n"
と式展開の閉じかっこを受け取るまでクオート文字列用プロンプトにならないようにな
っている(3行目のプロンプトが違う)のは確認できました。もっとなんか影響ありそうな
んですけどね。
