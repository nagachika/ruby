標準添付ライブラリ set の SortedSet#to_a が内部で使っている配列をそのまま返していたので、破壊的変更をすると SortedSet 自体に変更ができてしまっていたので dup して返すようにしています。 [ruby-core:92578] [Bug #15834]
