r33030 の元のソースコードが長いと行番号がオーバフローする問題の対処です。CRuby
の VM の命令列(ISeq) の各命令で行番号を含む情報を保持していたのを、行番号が変化
するところだけで持つようにして、そのかわり命令のカウンタと行番号を unsigned int
で持つようにしています。また既に不要になっていた sp(予想される消費スタックサイ
ズ?)というメンバを削除して、構造体の名称を変更(iseq_insn_info_entry ->
iseq_line_info_entry)しています。これでコンパイル後の命令列のメモリ使用量も削減
できるようです。[ruby-dev:44413] [Bug #5217]
