IO#each_byte のループで内部のバッファを最初に取得して終端を決めてからループして
いたために、ブロック内の操作で内部のバッファが更新されると止まらなくなってしま
う可能性があったのを修正しています。 [ruby-core:38609] [Bug #5119]
しかし IO#pos の呼び出しでバッファが flush されるというのはちょっと盲点ですね。
修正内容はわかるものの、しばらくなんで IO#pos を呼ぶことで発生するんだろうかと
思いました。
